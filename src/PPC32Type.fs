module PPC32DebugMPC560.Type

type Register =
  | R0 = 0x0
  | R1 = 0x1
  | R2 = 0x2
  | R3 = 0x3
  | R4 = 0x4
  | R5 = 0x5
  | R6 = 0x6
  | R7 = 0x7
  | R8 = 0x8
  | R9 = 0x9
  | R10 = 0xA
  | R11 = 0xB
  | R12 = 0xC
  | R13 = 0xD
  | R14 = 0xE
  | R15 = 0xF
  | R16 = 0x10
  | R17 = 0x11
  | R18 = 0x12
  | R19 = 0x13
  | R20 = 0x14
  | R21 = 0x15
  | R22 = 0x16
  | R23 = 0x17
  | R24 = 0x18
  | R25 = 0x19
  | R26 = 0x1A
  | R27 = 0x1B
  | R28 = 0x1C
  | R29 = 0x1D
  | R30 = 0x1E
  | R31 = 0x1F
  | F0 = 0x20
  | F1 = 0x21
  | F2 = 0x22
  | F3 = 0x23
  | F4 = 0x24
  | F5 = 0x25
  | F6 = 0x26
  | F7 = 0x27
  | F8 = 0x28
  | F9 = 0x29
  | F10 = 0x2A
  | F11 = 0x2B
  | F12 = 0x2C
  | F13 = 0x2D
  | F14 = 0x2E
  | F15 = 0x2F
  | F16 = 0x30
  | F17 = 0x31
  | F18 = 0x32
  | F19 = 0x33
  | F20 = 0x34
  | F21 = 0x35
  | F22 = 0x36
  | F23 = 0x37
  | F24 = 0x38
  | F25 = 0x39
  | F26 = 0x3A
  | F27 = 0x3B
  | F28 = 0x3C
  | F29 = 0x3D
  | F30 = 0x3E
  | F31 = 0x3F
  /// CR0 - CR7 is 4bit chunk of CR.
  | CR0 = 0x40
  | CR1 = 0x41
  | CR2 = 0x42
  | CR3 = 0x43
  | CR4 = 0x44
  | CR5 = 0x45
  | CR6 = 0x46
  | CR7 = 0x47
  /// XER Register.
  | XER = 0x70
  /// LR Register.
  | LR = 0x71
  /// Count Register.
  | CTR = 0x72
  /// FPSCR Register
  | FPSCR = 0x73
  /// Processor Version Register.
  | PVR = 0x74
  /// Pseudo register for Reserve.
  | RES = 0x75

/// Shortcut for Register type.
type internal R = Register

type opcode =
  | ADD = 0
  | ADDC = 1
  | ADDCdot = 2
  | ADDCO = 3
  | ADDCOdot = 4
  | ADDdot = 5
  | ADDE = 6
  | ADDEdot = 7
  | ADDEO = 8
  | ADDEOdot = 9
  | ADDI = 10
  | ADDIC = 11
  | ADDICdot = 12
  | ADDIS = 13
  | ADDME = 14
  | ADDMEdot = 15
  | ADDMEO = 16
  | ADDMEOdot = 17
  | ADDO = 18
  | ADDOdot = 19
  | ADDZE = 20
  | ADDZEdot = 21
  | ADDZEO = 22
  | ADDZEOdot = 23
  | AND = 24
  | ANDC = 25
  | ANDCdot = 26
  | ANDdot = 27
  | ANDIdot = 28
  | ANDISdot = 29
  | B = 30
  | BA = 31
  | BC = 32
  | BCA = 33
  | BCCTR = 34
  | BCCTRL = 35
  | BCL = 36
  | BCLA = 37
  | BCLR = 38
  | BCLRL = 39
  | BCTR = 40
  | BCTRL = 41
  | BDNZ = 42
  | BDNZA = 43
  | BDNZF = 44
  | BDNZFA = 45
  | BDNZFL = 46
  | BDNZFLA = 47
  | BDNZFLR = 48
  | BDNZFLRL = 49
  | BDNZL = 50
  | BDNZLA = 51
  | BDNZLR = 52
  | BDNZLRL = 53
  | BDNZT = 54
  | BDNZTA = 55
  | BDNZTL = 56
  | BDNZTLA = 57
  | BDNZTLR = 58
  | BDNZTLRL = 59
  | BDZ = 60
  | BDZA = 61
  | BDZF = 62
  | BDZFA = 63
  | BDZFL = 64
  | BDZFLA = 65
  | BDZFLR = 66
  | BDZFLRL = 67
  | BDZL = 68
  | BDZLA = 69
  | BDZLR = 70
  | BDZLRL = 71
  | BDZT = 72
  | BDZTA = 73
  | BDZTL = 74
  | BDZTLA = 75
  | BDZTLR = 76
  | BDZTLRL = 77
  | BEQ = 78
  | BEQA = 79
  | BEQCTR = 80
  | BEQCTRL = 81
  | BEQL = 82
  | BEQLA = 83
  | BEQLR = 84
  | BEQLRL = 85
  | BFLRL = 86
  | BGE = 87
  | BGEA = 88
  | BGECTR = 89
  | BGECTRL = 90
  | BGEL = 91
  | BGELA = 92
  | BGELR = 93
  | BGELRL = 94
  | BGT = 95
  | BGTA = 96
  | BGTCTR = 97
  | BGTCTRL = 98
  | BGTL = 99
  | BGTLA = 100
  | BGTLR = 101
  | BGTLRL = 102
  | BL = 103
  | BLA = 104
  | BLE = 105
  | BLEA = 106
  | BLECTR = 107
  | BLECTRL = 108
  | BLEL = 109
  | BLELA = 110
  | BLELR = 111
  | BLELRL = 112
  | BLR = 113
  | BLRL = 114
  | BLT = 115
  | BLTA = 116
  | BLTCTR = 117
  | BLTCTRL = 118
  | BLTL = 119
  | BLTLA = 120
  | BLTLR = 121
  | BLTLRL = 122
  | BNE = 123
  | BNEA = 124
  | BNECTR = 125
  | BNECTRL = 126
  | BNEL = 127
  | BNELA = 128
  | BNELR = 129
  | BNELRL = 130
  | BNS = 131
  | BNSA = 132
  | BNSCTR = 133
  | BNSCTRL = 134
  | BNSL = 135
  | BNSLA = 136
  | BNSLR = 137
  | BNSLRL = 138
  | BSO = 139
  | BSOA = 140
  | BSOCTR = 141
  | BSOCTRL = 142
  | BSOL = 143
  | BSOLA = 144
  | BSOLR = 145
  | BSOLRL = 146
  | BTCTRL = 147
  | BTLRL = 148
  | CLRLWI = 149
  | CLRRWI = 150
  | CMP = 151
  | CMPI = 152
  | CMPL = 153
  | CMPLI = 154
  | CMPLW = 155
  | CMPLWI = 156
  | CMPW = 157
  | CMPWI = 158
  | CNTLZW = 159
  | CNTLZWdot = 160
  | CRAND = 161
  | CRANDC = 162
  | CRCLR = 163
  | CREQV = 164
  | CRMOVE = 165
  | CRNAND = 166
  | CRNOR = 167
  | CRNOT = 168
  | CROR = 169
  | CRORC = 170
  | CRSET = 171
  | CRXOR = 172
  | DCBA = 173
  | DCBF = 174
  | DCBI = 175
  | DCBST = 176
  | DCBT = 177
  | DCBTST = 178
  | DCBZ = 179
  | DIVW = 180
  | DIVWdot = 181
  | DIVWO = 182
  | DIVWOdot = 183
  | DIVWU = 184
  | DIVWUdot = 185
  | DIVWUO = 186
  | DIVWUOdot = 187
  | ECIWX = 188
  | ECOWX = 189
  | EIEIO = 190
  | EQV = 191
  | EQVdot = 192
  | EXTSB = 193
  | EXTSBdot = 194
  | EXTSH = 195
  | EXTSHdot = 196
  | FABS = 197
  | FABSdot = 198
  | FADD = 199
  | FADDdot = 200
  | FADDS = 201
  | FADDSdot = 202
  | FCMPO = 203
  | FCMPU = 204
  | FCTIW = 205
  | FCTIWdot = 206
  | FCTIWZ = 207
  | FCTIWZdot = 208
  | FDIV = 209
  | FDIVdot = 210
  | FDIVS = 211
  | FDIVSdot = 212
  | FMADD = 213
  | FMADDdot = 214
  | FMADDS = 215
  | FMADDSdot = 216
  | FMR = 217
  | FMRdot = 218
  | FMSUB = 219
  | FMSUBdot = 220
  | FMSUBS = 221
  | FMSUBSdot = 222
  | FMUL = 223
  | FMULdot = 224
  | FMULS = 225
  | FMULSdot = 226
  | FNABS = 227
  | FNABSdot = 228
  | FNEG = 229
  | FNEGdot = 230
  | FNMADD = 231
  | FNMADDdot = 232
  | FNMADDS = 233
  | FNMADDSdot = 234
  | FNMSUB = 235
  | FNMSUBdot = 236
  | FNMSUBS = 237
  | FNMSUBSdot = 238
  | FRES = 239
  | FRESdot = 240
  | FRSP = 241
  | FRSPdot = 242
  | FRSQRTE = 243
  | FRSQRTEdot = 244
  | FSEL = 245
  | FSELdot = 246
  | FSQRT = 247
  | FSQRTdot = 248
  | FSQRTS = 249
  | FSQRTSdot = 250
  | FSUB = 251
  | FSUBdot = 252
  | FSUBS = 253
  | FSUBSdot = 254
  | ICBI = 255
  | InvalOP = 256
  | ISYNC = 257
  | LBZ = 258
  | LBZU = 259
  | LBZUX = 260
  | LBZX = 261
  | LFD = 262
  | LFDU = 263
  | LFDUX = 264
  | LFDX = 265
  | LFS = 266
  | LFSU = 267
  | LFSUX = 268
  | LFSX = 269
  | LHA = 270
  | LHAU = 271
  | LHAUX = 272
  | LHAX = 273
  | LHBRX = 274
  | LHZ = 275
  | LHZU = 276
  | LHZUX = 277
  | LHZX = 278
  | LI = 279
  | LIS = 280
  | LMW = 281
  | LSWI = 282
  | LSWX = 283
  | LWARX = 284
  | LWBRX = 285
  | LWSYNC = 286
  | LWZ = 287
  | LWZU = 288
  | LWZUX = 289
  | LWZX = 290
  | MCRF = 291
  | MCRFS = 292
  | MCRXR = 293
  | MFCR = 294
  | MFCTR = 295
  | MFFS = 296
  | MFFSdot = 297
  | MFLR = 298
  | MFMSR = 299
  | MFSPR = 300
  | MFSR = 301
  | MFSRIN = 302
  | MFTB = 303
  | MFTBU = 304
  | MFXER = 305
  | MR = 306
  | MTCRF = 307
  | MTCTR = 308
  | MTFSB0 = 309
  | MTFSB0dot = 310
  | MTFSB1 = 311
  | MTFSB1dot = 312
  | MTFSF = 313
  | MTFSFdot = 314
  | MTFSFI = 315
  | MTFSFIdot = 316
  | MTLR = 317
  | MTMSR = 318
  | MTSPR = 319
  | MTSR = 320
  | MTSRIN = 321
  | MTXER = 322
  | MULHW = 323
  | MULHWdot = 324
  | MULHWU = 325
  | MULHWUdot = 326
  | MULLI = 327
  | MULLW = 328
  | MULLWdot = 329
  | MULLWO = 330
  | MULLWOdot = 331
  | NAND = 332
  | NANDdot = 333
  | NEG = 334
  | NEGdot = 335
  | NEGO = 336
  | NEGOdot = 337
  | NOP = 338
  | NOR = 339
  | NORdot = 340
  | OR = 341
  | ORC = 342
  | ORCdot = 343
  | ORdot = 344
  | ORI = 345
  | ORIS = 346
  | RFI = 347
  | RLWIMI = 348
  | RLWIMIdot = 349
  | RLWINM = 350
  | RLWINMdot = 351
  | RLWNM = 352
  | RLWNMdot = 353
  | ROTLW = 354
  | ROTLWI = 355
  | SC = 356
  | SLW  = 357
  | SLWdot = 358
  | SLWI = 359
  | SRAW = 360
  | SRAWdot = 361
  | SRAWI = 362
  | SRAWIdot = 363
  | SRW = 364
  | SRWdot = 365
  | SRWI = 366
  | STB = 367
  | STBU = 368
  | STBUX = 369
  | STBX = 370
  | STFD = 371
  | STFDU = 372
  | STFDUX = 373
  | STFDX = 374
  | STFIWX = 375
  | STFS = 376
  | STFSU = 377
  | STFSUX = 378
  | STFSX = 379
  | STH = 380
  | STHBRX = 381
  | STHU = 382
  | STHUX = 383
  | STHX = 384
  | STMW = 385
  | STSWI = 386
  | STSWX = 387
  | STW = 388
  | STWBRX = 389
  | STWCXdot = 390
  | STWU = 391
  | STWUX = 392
  | STWX = 393
  | SUBF = 394
  | SUBFC = 395
  | SUBFCdot = 396
  | SUBFCO = 397
  | SUBFCOdot = 398
  | SUBFdot = 399
  | SUBFE = 400
  | SUBFEdot = 401
  | SUBFEO = 402
  | SUBFEOdot = 403
  | SUBFIC = 404
  | SUBFME = 405
  | SUBFMEdot = 406
  | SUBFMEO = 407
  | SUBFMEOdot = 408
  | SUBFO = 409
  | SUBFOdot = 410
  | SUBFZE = 411
  | SUBFZEdot = 412
  | SUBFZEO = 413
  | SUBFZEOdot = 414
  | SYNC = 415
  | TLBIA = 416
  | TLBIE = 417
  | TLBSYNC = 418
  | TRAP = 419
  | TW = 420
  | TWEQ = 421
  | TWEQI = 422
  | TWGE = 423
  | TWGEI = 424
  | TWGT = 425
  | TWGTI = 426
  | TWI = 427
  | TWLE = 428
  | TWLEI = 429
  | TWLGT = 430
  | TWLGTI = 431
  | TWLLE = 432
  | TWLLEI = 433
  | TWLLT = 434
  | TWLLTI = 435
  | TWLNL = 436
  | TWLNLI = 437
  | TWLT = 438
  | TWLTI = 439
  | TWNE = 440
  | TWNEI = 441
  | XOR = 442
  | XORdot = 443
  | XORI = 444
  | XORIS = 445

type internal Op = Opcode

type Condition =
  /// Less than [LT].
  | LT = 0x0
  /// Less than or equal (equivalent to ng) [GT].
  | LE = 0x1
  /// Equal [EQ].
  | EQ = 0x2
  /// Greater than or equal (equivalent to nl) [LT].
  | GE = 0x3
  /// Greater than [GT].
  | GT = 0x4
  /// Not less than (equivalent to ge) [LT].
  | NL = 0x5
  /// Not equal [EQ].
  | NE = 0x6
  /// Not greater than (equivalent to le) [GT].
  | NG = 0x7
  /// Summary overflow [SO].
  | SO = 0x8
  /// Not summary overflow [SO].
  | NS = 0x9
  /// Unordered (after floating-point comparison) [SO].
  | UN = 0xA
  /// Not unordered (after floating-point comparison) [SO].
  | NU = 0xB

type Operand =
  | OprReg of Register
  | OprMem of D * Register
  | OprImm of Imm
  | OprAddr of TargetAddr
  | OprBI of uint32
and D = int32
and Imm = uint64
and TargetAddr = uint64

type Operands =
  | NoOperand
  | OneOperand of Operand
  | TwoOperands of Operand * Operand
  | ThreeOperands of Operand * Operand * Operand
  | FourOperands of Operand * Operand * Operand * Operand
  | FiveOperands of Operand * Operand * Operand * Operand * Operand

let toString = function
    | R.R0 -> "r0"
    | R.R1 -> "r1"
    | R.R2 -> "r2"
    | R.R3 -> "r3"
    | R.R4 -> "r4"
    | R.R5 -> "r5"
    | R.R6 -> "r6"
    | R.R7 -> "r7"
    | R.R8 -> "r8"
    | R.R9 -> "r9"
    | R.R10 -> "r10"
    | R.R11 -> "r11"
    | R.R12 -> "r12"
    | R.R13 -> "r13"
    | R.R14 -> "r14"
    | R.R15 -> "r15"
    | R.R16 -> "r16"
    | R.R17 -> "r17"
    | R.R18 -> "r18"
    | R.R19 -> "r19"
    | R.R20 -> "r20"
    | R.R21 -> "r21"
    | R.R22 -> "r22"
    | R.R23 -> "r23"
    | R.R24 -> "r24"
    | R.R25 -> "r25"
    | R.R26 -> "r26"
    | R.R27 -> "r27"
    | R.R28 -> "r28"
    | R.R29 -> "r29"
    | R.R30 -> "r30"
    | R.R31 -> "r31"
    | R.F0 -> "f0"
    | R.F1 -> "f1"
    | R.F2 -> "f2"
    | R.F3 -> "f3"
    | R.F4 -> "f4"
    | R.F5 -> "f5"
    | R.F6 -> "f6"
    | R.F7 -> "f7"
    | R.F8 -> "f8"
    | R.F9 -> "f9"
    | R.F10 -> "f10"
    | R.F11 -> "f11"
    | R.F12 -> "f12"
    | R.F13 -> "f13"
    | R.F14 -> "f14"
    | R.F15 -> "f15"
    | R.F16 -> "f16"
    | R.F17 -> "f17"
    | R.F18 -> "f18"
    | R.F19 -> "f19"
    | R.F20 -> "f20"
    | R.F21 -> "f21"
    | R.F22 -> "f22"
    | R.F23 -> "f23"
    | R.F24 -> "f24"
    | R.F25 -> "f25"
    | R.F26 -> "f26"
    | R.F27 -> "f27"
    | R.F28 -> "f28"
    | R.F29 -> "f29"
    | R.F30 -> "f30"
    | R.F31 -> "f31"
    | R.CR0 -> "cr0"
    | R.CR1 -> "cr1"
    | R.CR2 -> "cr2"
    | R.CR3 -> "cr3"
    | R.CR4 -> "cr4"
    | R.CR5 -> "cr5"
    | R.CR6 -> "cr6"
    | R.CR7 -> "cr7"
    | R.RES -> "res"
    | _ -> ""